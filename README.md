# nixpkgs-vim-extra-plugins

Nix flake of miscellaneous Vim/Neovim plugins.

## Table of contents

- [Description](#description)
- [Usage](#usage)
    - [In flake](#in-flake)
    - [In legacy Nix](#in-legacy-nix)
    - [Via NUR](#via-nur)
- [Available Vim/Neovim plugins](#available-vimneovim-plugins)
- [Contribution](#contribution)
    - [How to add a new plugin](#how-to-add-a-new-plugin)
- [License](#license)

## Description

This flake contains Nix packages of miscellaneous Vim/Neovim plugins.
Most of them are simply not provided by the official nixpkgs.
Some of them are provided but patched in this flake, or their version/revision
in the official nixpkgs is not up to date for my use case.

Packages are automatically updated twice per week using GitHub Actions.

Moreover, Neovim plugins listed in [awesome-neovim][0] are automatically generated by
parsing the README. Since these packages are automatically generated, some of them could
be broken due to lack of appropriate overrides (missing dependencies, build inputs, etc.).
So you should be careful if you want to use them.

## Usage

### In flake

The overlay simply adds extra Vim plugins into `pkgs.vimExtraPlugins`.
Use it as you normally do, like

```nix
{
  inputs = {
    flake-utils.url = "github:numtide/flake-utils";
    vim-extra-plugins.url = "github:m15a/nixpkgs-vim-extra-plugins";
  };
  outputs = { self, nixpkgs, flake-utils, vim-extra-plugins, ... }:
  flake-utils.lib.eachDefaultSystem (system:
  let
    pkgs = import nixpkgs {
      inherit system;
      overlays = [ vim-extra-plugins.overlays.default ];
    };
  in {
    packages = {
      my-neovim = pkgs.neovim.override {
        configure = {
          packages.example = with pkgs.vimExtraPlugins; {
            start = [
              lspactions
              vim-hy
            ];
          };
        };
      };
    };
  });
}
```

### In legacy Nix

It is handy to use `builtins.getFlake`, which was [introduced in Nix 2.4][1]. For example,

```nix
with import <nixpkgs> {
  overlays = [
    (builtins.getFlake "github:m15a/nixpkgs-vim-extra-plugins").overlays.default
  ];
};
```

For Nix <2.4, use `builtins.fetchTarball` instead.

```nix
with import <nixpkgs> {
  overlays = [
    (import (builtins.fetchTarball {
      url = "https://github.com/m15a/nixpkgs-vim-extra-plugins/archive/main.tar.gz";
    })).overlays.default
  ];
};
```

### Via NUR

You can also use it via [NUR][2] at `nur.repos.m15a.vimExtraPlugins`, see [the package list][3].

[0]: https://github.com/rockerBOO/awesome-neovim
[1]: https://nixos.org/manual/nix/stable/release-notes/rl-2.4.html?highlight=builtins.getFlake#other-features
[2]: https://nur.nix-community.org/
[3]: https://nur.nix-community.org/repos/m15a/

## Available Vim/Neovim plugins

The [plugins.md](plugins.md) contains a list of all plugins.

## Contribution

### How to add a new plugin

#### 1. Add a new entry to `manifest.txt`
Add the plugin to manifest.txt:

```
# Examples

haringsrob/nvim_context_vt
williamboman/mason.nvim:45b9a4da776d9fb017960b3ac7241161fb7bc578
sourcehut:henriquehbr/ataraxis.lua
gitlab:yorickpeterse/nvim-pqf
foo/bar::baz # renamed to baz
foo/bar:dev # using dev branch
```

Supported are Github (default), SourceHut, GitLab.

#### 2. Format the Manifest and Generate the plugins (optional)

```
nix run .#update-vim-plugins -- lint
nix run .#update-vim-plugins
```

This updates pkgs/vim-plugins.nix and README.md`

#### 3. Override your plugin derivation in `overrides.nix`

In `overrides.nix`, you see something like

```nix
  {
    # ...

    lspactions = super.lspactions.overrideAttrs (_: {
      dependencies = with final.vimPlugins; [
        plenary-nvim
        popup-nvim
        self.astronauta-nvim
      ];
    });

    # ...
  }
```

Add your overrides here if needed.

#### 4. Create a Pull Request

Anyone is welcome to add another plugin to this repo.
Feel free to create a PR with your new plugins!
In that case, make sure you commit
`manifest.txt`, `pkgs/vim-plugins.nix`, and optionally `overrides.nix` if changed.
`README.md` will be updated by GitHub Action so it is not mandatory.

## License

[MIT](LICENSE)
